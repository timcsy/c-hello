# 任務清單：摩斯密碼練習網站

**輸入**: 設計文檔來自 `/specs/`  
**前置條件**: plan.md (已完成)、spec.md (已完成、已澄清)

**組織**: 任務按使用者故事分組，支援獨立實現與測試每個故事

## 格式：`[ID] [P?] [Story?] 描述`

- **[P]**: 可並行執行（不同檔案、無依賴）
- **[Story]**: 此任務屬於哪個使用者故事（例如 US1、US2、US3）
- **描述中包含確切檔案路徑**

## 路徑約定

- **源代碼**: `src/` 於專案根目錄
- **測試**: `tests/` 於專案根目錄
- **部署**: `dist/` 為最終 GitHub Pages 產物

---

## Phase 1: 設置 (共享基礎設施)

**目標**: 專案初始化與基本結構

- [x] T001 根據實現計畫建立專案結構 (`src/`、`tests/`、`dist/`)
- [x] T002 [P] 初始化 npm 專案，安裝 Vite 與必要依賴
- [x] T003 [P] 配置 Vite 打包工具 (`vite.config.js`)
- [x] T004 [P] 設置 ESLint 與 Prettier 代碼格式化工具
- [x] T005 [P] 建立 GitHub Actions 部署工作流 (`.github/workflows/deploy.yml`)

**檢查點**: 基礎設施就位 - 可開始使用者故事實現

---

## Phase 2: 基礎 (阻塞性前置條件)

**目標**: 所有使用者故事必須完成的核心基礎設施

**⚠️ 關鍵**: 此階段未完成前，任何使用者故事工作無法開始

- [x] T006 [P] 建立摩斯碼字典模組 `src/js/morse-dictionary.js` (字母、數字、符號映射)
- [x] T007 [P] 建立摩斯編碼模組 `src/js/morse-encoder.js` (文字轉摩斯碼)
- [x] T008 [P] 建立摩斯解碼模組 `src/js/morse-decoder.js` (摩斯碼轉文字)
- [x] T009 [P] 建立音頻引擎模組 `src/js/audio-engine.js` (Web Audio API 封裝)
- [x] T010 [P] 建立 LocalStorage 管理模組 `src/js/storage.js` (用戶偏好存儲)
- [x] T011 建立主 HTML 頁面 `src/index.html` (基本結構、標籤、佈局框架)
- [x] T012 [P] 建立主樣式表 `src/styles/main.css` (佈局、排版、色彩方案)
- [x] T013 [P] 建立響應式設計樣式 `src/styles/responsive.css` (行動設備最佳化)
- [x] T014 [P] 建立無障礙支持樣式 `src/styles/accessibility.css` (鍵盤導航、對比度)

**檢查點**: 基礎完成 - 使用者故事實現可開始並行進行

---

## Phase 3: 使用者故事 1 - 基礎摩斯密碼練習 (優先級: P1) 🎯 MVP

**目標**: 提供鍵盤/觸控輸入、實時音頻反饋、即時摩斯碼解碼

**獨立測試**: 在瀏覽器中開啟頁面，能按鍵/觸控輸入摩斯碼、聽到對應音頻、看到解碼結果

### US1 實現

- [x] T015 [P] [US1] 實現輸入處理器 `src/js/input-handler.js` (鍵盤 + 觸控事件)
- [x] T016 [P] [US1] 實現 UI 控制器模組 `src/js/ui-controller.js` (DOM 操作、元素更新)
- [x] T017 [US1] 整合輸入→音頻→UI 流程，在 `src/js/app.js` 主邏輯
- [x] T018 [US1] 建立摩斯碼顯示區域 HTML 與樣式 (在 `src/index.html` 與 `src/styles/main.css`)
- [x] T019 [US1] 實現實時摩斯碼符號顯示 (點 · 和劃 −)
- [x] T020 [US1] 實現實時摩斯碼解碼與字符顯示

**檢查點**: US1 可獨立運作 - 用戶能輸入摩斯碼並看到解碼結果

---

## Phase 4: 使用者故事 2 - 調整練習速度 (優先級: P2)

**目標**: 提供可調節的時間參數控制

**獨立測試**: 參數面板出現、調整參數後輸入摩斯碼時間感應改變

### US2 實現

- [x] T021 [P] [US2] 建立參數控制 UI `src/index.html` (滑塊、輸入框、標籤)
- [x] T022 [P] [US2] 建立參數樣式 `src/styles/main.css` (參數面板佈局)
- [x] T023 [US2] 實現參數讀取與驗證邏輯 `src/js/app.js`
- [x] T024 [US2] 實現參數儲存到 LocalStorage `src/js/storage.js`
- [x] T025 [US2] 實現參數載入與回復預設值邏輯
- [x] T026 [US2] 連接參數變更到音頻引擎與輸入處理器 (即時生效)

**檢查點**: US1 + US2 可同時運作 - 時間參數可調整且即時生效

---

## Phase 5: 使用者故事 3 - 驗證練習成果 (優先級: P3)

**目標**: 提供挑戰模式以驗證摩斯碼輸入准確性

**獨立測試**: 切換到挑戰模式、系統提示字母、輸入摩斯碼後顯示是否正確、統計準確率

### US3 實現

- [x] T027 [P] [US3] 建立標籤切換 UI `src/index.html` (自由練習 / 挑戰模式)
- [x] T028 [P] [US3] 建立標籤樣式與活動狀態 `src/styles/main.css`
- [x] T029 [US3] 實現挑戰模式狀態管理 `src/js/app.js`
- [x] T030 [US3] 實現隨機字母生成與顯示邏輯 `src/js/app.js`
- [x] T031 [US3] 實現使用者輸入驗證邏輯 (比對摩斯碼是否正確)
- [x] T032 [US3] 實現正確/錯誤視覺反饋 `src/styles/main.css` (色彩閃爍或邊框)
- [x] T033 [US3] 實現統計數據計算 (字元數、正確數、準確率) `src/js/app.js`
- [x] T034 [US3] 實現統計數據顯示面板 `src/index.html` 與 `src/styles/main.css`

**檢查點**: US1 + US2 + US3 全部可運作 - 三種練習模式完整

---

## Phase 6: 使用者故事 4 - 部署至 GitHub Pages (優先級: P4)

**目標**: 自動化 Build 與部署流程

**獨立測試**: GitHub Actions 工作流執行成功、GitHub Pages 部署完成、網站可訪問

### US4 實現

- [x] T035 [US4] 配置 Vite 輸出到 `dist/` 目錄 (`vite.config.js`)
- [x] T036 [US4] 建立 Build 腳本 `package.json` (`npm run build`)
- [x] T037 [US4] 完成 GitHub Actions 部署工作流 `.github/workflows/deploy.yml`
- [x] T038 [US4] 配置 GitHub Pages 設定 (部署分支、自訂網域等)
- [x] T039 [US4] 驗證部署產物完整性與資源路徑相容性
- [x] T040 [US4] 測試 GitHub Pages 部署後網站完全可用 (所有連結、資源、功能)

**檢查點**: 網站部署至 GitHub Pages、完全可用

---

## Phase 7: 美化與跨領域改進

**目標**: 提升效能、無障礙、使用者體驗

- [x] T041 [P] 實現視覺降級模式 (音頻不可用時色彩提示) `src/js/audio-engine.js` 與 `src/styles/main.css`
- [x] T042 [P] 實現音量調整滑塊 `src/index.html` 與 `src/js/app.js`
- [x] T043 [P] 實現靜音切換按鈕 `src/index.html` 與 `src/js/app.js`
- [x] T044 [P] 驗證 WCAG 2.1 AA 無障礙標準合規性 (鍵盤導航、螢幕閱讀器)
- [ ] T045 [P] 性能優化：測試並優化首次加載時間 (目標 < 2 秒)
- [ ] T046 [P] 性能優化：測試並優化音頻延遲 (目標 < 50ms)
- [ ] T047 [P] 代碼清理與重構：移除重複代碼
- [x] T048 [P] 文檔更新：`README.md` 使用說明、開發指南
- [ ] T049 [P] 跨瀏覽器相容性測試 (Chrome、Firefox、Safari、Edge)
- [ ] T050 [P] 跨設備響應式測試 (桌面、平板、行動)

**檢查點**: 所有使用者故事完成、網站已優化與部署

---

## 依賴關係與執行順序

### 階段依賴

- **Phase 1 (設置)**: 無依賴 - 可立即開始
- **Phase 2 (基礎)**: 依賴 Phase 1 完成 - **阻塞所有使用者故事**
- **Phase 3-5 (使用者故事)**: 依賴 Phase 2 完成
  - US1、US2、US3 可並行進行 (如有足夠人力)
  - 或按優先級順序進行 (P1 → P2 → P3)
- **Phase 6 (部署)**: 依賴 US1-US3 完成
- **Phase 7 (美化)**: 依賴所有使用者故事完成

### 使用者故事依賴

- **US1 (P1)**: 可在 Phase 2 完成後開始 - 無對其他故事的依賴
- **US2 (P2)**: 可在 Phase 2 完成後開始 - 獨立於 US1
- **US3 (P3)**: 可在 Phase 2 完成後開始 - 獨立於 US1、US2
- **US4 (P4)**: 依賴 US1-US3 基本完成

### 每個使用者故事內

- 模型/數據結構優先
- 業務邏輯次之
- UI/輸入處理最後
- 故事完成後再進行下一優先級

### 並行機會

- Phase 1 所有 [P] 任務可並行
- Phase 2 所有 [P] 任務可並行 (需先完成 Phase 1)
- Phase 2 完成後，US1-US3 可由不同開發者並行進行
- 同一故事內的 [P] 任務可並行 (如不同檔案)

---

## 並行執行範例：使用者故事 1

```bash
# 基礎模組可並行建立 (Phase 2):
- T006: 摩斯字典
- T007: 摩斯編碼
- T008: 摩斯解碼
- T009: 音頻引擎
- T010: 存儲管理

# US1 實現可並行部分 (Phase 3):
- T015: 輸入處理器
- T016: UI 控制器
- T018: HTML 結構

# 最後整合:
- T017: 主邏輯整合
- T019-T020: 顯示與解碼
```

---

## 實現策略

### MVP 優先 (僅使用者故事 1)

1. 完成 Phase 1: 設置
2. 完成 Phase 2: 基礎
3. 完成 Phase 3: US1
4. **暫停並驗證**: US1 獨立可運作
5. 部署/演示 (如無問題)

### 增量交付

1. Phase 1 + Phase 2 → 基礎就位
2. + US1 → 測試獨立可用 → 演示 (MVP!)
3. + US2 → 測試獨立可用 → 演示
4. + US3 → 測試獨立可用 → 演示
5. 每個故事增加價值而不破壞前面的功能

### 平行團隊策略

若有多位開發者：

1. 團隊共同完成 Phase 1 + Phase 2
2. Phase 2 完成後：
   - 開發者 A: US1
   - 開發者 B: US2
   - 開發者 C: US3
3. 故事完成並獨立整合

---

## 任務執行檢查清單

| 階段 | 任務數 | 估計時間 | 並行機會 | 優先級 |
|------|--------|---------|---------|--------|
| Phase 1 | 5 | 2-3 小時 | 4/5 [P] | P0 |
| Phase 2 | 9 | 4-6 小時 | 8/9 [P] | P0 |
| Phase 3 (US1) | 6 | 3-4 小時 | 3/6 [P] | P1 🎯 |
| Phase 4 (US2) | 6 | 2-3 小時 | 2/6 [P] | P2 |
| Phase 5 (US3) | 8 | 3-4 小時 | 3/8 [P] | P3 |
| Phase 6 (部署) | 6 | 1-2 小時 | 1/6 [P] | P4 |
| Phase 7 (美化) | 10 | 4-6 小時 | 8/10 [P] | P5 |
| **總計** | **50** | **19-28 小時** | **29/50 [P]** | - |

---

## 注意事項

- [P] 任務 = 不同檔案、無依賴
- [Story] 標籤映射任務至特定使用者故事
- 每個使用者故事應獨立可完成與測試
- 在每個檢查點驗證故事獨立運作
- 在每個階段完成後提交代碼
- MVP 範圍：僅 Phase 1 + Phase 2 + Phase 3 (US1)
- 完整功能：所有階段完成後部署
